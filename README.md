# AI LangChain 智能问答系统

一个基于 LangChain 框架的智能问答系统，支持文档上传、向量检索、网络搜索和对话记忆功能。

## 🌟 功能特性

- **📄 多格式文档支持**: 支持 `.txt`、`.pdf`、`.docx` 格式文档上传
- **🔍 智能向量检索**: 使用 FAISS 和 SentenceTransformer 构建向量数据库
- **🌐 网络搜索**: 集成 SerpAPI 实现实时网络搜索
- **💬 对话记忆**: 支持多轮对话，保持上下文连续性
- **🎨 现代化界面**: 基于 Gradio 的美观 Web 界面
- **⚡ 高性能**: 使用 FAISS 进行快速相似度检索

## 🚀 快速开始

### 环境要求

- Python 3.8+
- 需要 OpenAI API Key 和 SerpAPI Key

### 安装依赖

```bash
pip install -r requirements.txt
```

### 配置环境变量

创建 `.env` 文件并添加以下配置：

```env
OPENAI_API_KEY=your_openai_api_key_here
SERPAPI_API_KEY=your_serpapi_key_here
```

### 运行应用

```bash
python main.py
```

启动后访问显示的本地地址（通常是 `http://127.0.0.1:7860`）

## 📖 使用指南

### 1. 上传文档
- 点击"上传文件"按钮选择文档
- 支持的文件格式：`.txt`、`.pdf`、`.docx`
- 系统会自动处理文档并构建向量数据库

### 2. 选择搜索模式
- **不使用联网搜索**: 仅基于上传的文档进行问答
- **使用联网搜索**: 结合网络搜索和文档检索

### 3. 开始对话
- 在输入框中输入问题
- 点击"🚀 提交"或按回车键发送
- 系统会基于相关文档和对话历史给出回答

### 4. 清除对话
- 点击"🧹 清除历史对话"按钮重置对话历史

## 🏗️ 项目结构

```
AI_LangChain/
├── main.py              # 主程序入口，包含 Gradio 界面
├── chain.py             # 检索链核心逻辑
├── fileload.py          # 文档加载工具类
├── requirements.txt     # 项目依赖
├── .env                 # 环境变量配置
└── README.md           # 项目说明文档
```

## 🔧 核心组件

### RetrievalChain 类
- **功能**: 核心检索和对话逻辑
- **特性**: 
  - 支持文档检索和网络搜索
  - 对话记忆管理
  - 可配置的检索模式

### 文档处理流程
1. **文档解析**: 支持多种格式文档的内容提取
2. **文本分块**: 将长文档分割为256词的块，重叠32词
3. **向量化**: 使用 SentenceTransformer 生成文档向量
4. **索引构建**: 使用 FAISS 构建高效的向量索引

### 检索策略
- **相似度计算**: 使用 L2 距离计算文档相似度
- **Top-K 检索**: 返回最相关的2个文档块
- **上下文整合**: 将检索到的文档作为上下文输入模型

## ⚙️ 技术栈

- **LangChain**: 大语言模型应用框架
- **FAISS**: Facebook AI 相似性搜索库
- **SentenceTransformer**: 句子嵌入模型
- **Gradio**: Web 界面框架
- **OpenAI API**: 大语言模型服务
- **SerpAPI**: 网络搜索 API

## 🔒 注意事项

1. **VPN 设置**: 启动前请关闭 VPN，避免网络连接问题
2. **API 限制**: 注意 OpenAI 和 SerpAPI 的使用限制
3. **文档大小**: 大型文档可能需要较长的处理时间
4. **内存使用**: 向量数据库会占用一定的内存空间

## 🐛 成果展示
